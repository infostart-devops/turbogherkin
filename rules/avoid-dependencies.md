# Обеспечивайте полную независимость и самодостаточность сценариев

Нужно стремиться каждый сценарий делать полностью независимым и самодостаточным. Это означает, что его результат не должен зависеть от выполнения других сценариев, и он сам не должен влиять на последующие сценарии непредсказуемым образом.

**Почему зависимости между сценариями — это критически плохо?**
*   **Хрупкость и нестабильность:** Зависимые сценарии легко ломаются при изменении других, казалось бы, не связанных тестов.
*   **Эффект "домино":** Ошибка в одном сценарии может вызвать каскадное падение множества других зависимых сценариев, что затрудняет локализацию исходной проблемы.
*   **Сложность отладки:** Поиск причины сбоя в цепочке зависимых тестов становится значительно сложнее.
*   **Невозможность параллельного выполнения:** Зависимые тесты часто нельзя эффективно распараллелить, что замедляет общий прогон.
*   **Трудности в поддержке:** Изменение или удаление одного сценария может потребовать пересмотра многих других.

**Золотое правило: Каждый сценарий сам подготавливает свое окружение и данные**
*   Сценарий должен самостоятельно устанавливать все необходимые начальные условия (preconditions) для своего выполнения. Это включает создание тестовых данных, настройку состояния системы, открытие нужных форм и т.д.
*   Не полагайтесь на то, что предыдущий сценарий оставит систему в нужном для вас состоянии или создаст необходимые данные.

**Распространенные типы зависимостей и как их избежать:**

1.  **Зависимость от данных, созданных другими сценариями:**
    *   **❌ Неправильно:** Сценарий А создает запись (элемент справочника, документ, набор данных или запись регистра), а сценарий Б ожидает, что эта запись существует и использует ее.
    *   **✔️ Правильно:** Сценарий Б должен сам создавать необходимую ему запись в своих шагах `Дано` или явно вызывать специализированный экспортный сценарий для подготовки этих данных.

2.  **Зависимость от состояния пользовательского интерфейса (UI):**
    *   **Ожидание закрытых окон:**
        *   **❌ Неправильно:** Сценарий предполагает, что к его началу все окна будут закрыты.
        *   **✔️ Правильно:** Сценарий сам должен обеспечить закрытие всех ненужных окон. Этот шаг часто является общим для многих сценариев и может быть вынесен в блок `Контекст:` для автоматического выполнения перед каждым сценарием фичи.
    *   **Ожидание открытого конкретного окна:**
        *   **❌ Неправильно:** Сценарий А открывает окно, а сценарий Б (следующий в том же файле) продолжает работу в этом окне.
        *   **✔️ Правильно:** Сценарий Б должен сам явно открывать окно, с которым он собирается работать.
    *   **Зависимость от состояния специфичных элементов управления:**
        *   **❌ Неправильно:** Сценарий не устанавливает явно режим просмотра списка (например, иерархический или плоский) перед использованием шагов навигации по этому списку (`И в таблице "ИмяТаблицы" я перехожу к строке` и т.п.). Если предыдущий сценарий изменил режим просмотра на неподходящий, текущий сценарий упадет.
        *   **✔️ Правильно:** Перед выполнением действий, зависящих от режима элемента управления, сценарий должен явно установить этот режим в нужное состояние. Например, если мы выполняем поиск по всему иерархическому справочнику без учета иерархии, то перед выполнением поиска нужно включить режим просмотра "Список" шагом `И я нажимаю на кнопку с именем 'ФормаСписок'`.

**Общий принцип устойчивости:**
Хорошо написанный сценарий должен корректно выполняться независимо от того, какие другие сценарии выполнялись до него и в каком порядке. Представляйте, что ваш сценарий может быть запущен первым, последним или единственным.

