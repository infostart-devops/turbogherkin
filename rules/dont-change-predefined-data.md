# Запрещается изменять эталонные (предопределенные) данные в сценариях

**Основной принцип:** Эталонные данные, подготовленные заранее и используемые совместно несколькими сценариями, должны рассматриваться как **неизменяемые (read-only)**. Любые модификации таких данных в ходе выполнения сценария недопустимы.

Старайтесь **минимизировать количество и сложность общих эталонных данных**. Чем меньше таких данных и чем они проще, тем ниже риск возникновения неявных зависимостей между сценариями. 

**Почему изменение общих эталонных данных — это критически плохо?**

*   **Нестабильность тестов ("флапинг"):** Если один сценарий изменяет общие данные (например, меняет вид контрагента с "Поставщик" на "Клиент"), другие сценарии, полагающиеся на исходное состояние этих данных, начнут падать. Результаты тестов становятся непредсказуемыми.
*   **Эффект "домино":** Ошибка или изменение в одном сценарии, затрагивающее общие данные, может вызвать каскадное падение множества других, формально не связанных, сценариев.
*   **Сложность отладки:** Поиск причины сбоя становится крайне затруднительным, так как проблема может быть не в самом упавшем сценарии, а в том, который ранее некорректно изменил общие данные.
*   **Проблемы с параллельным выполнением:** Изменение общих данных делает невозможным или очень рискованным параллельный запуск тестов, так как сценарии будут "конфликтовать" за состояние этих данных.

**Что делать, если сценарию нужны специфические или измененные данные?**

Если вашему сценарию для проверки определенной логики требуются данные, отличающиеся от эталонных, или если он должен изменять какие-либо атрибуты данных:
1.  **Создавайте собственные данные:** Сценарий должен самостоятельно создавать необходимые ему экземпляры данных в своих шагах `Дано`. Эти данные будут локальными для данного сценария и не повлияют на другие.
2.  **Копируйте и изменяйте (если применимо и безопасно):** Можно создать копию соответствующего эталонного объекта и затем изменять ее. Но в общем случае предпочтительнее полное создание нужных данных с нуля для большей изоляции.

**Пример:**

Допустим, в эталонной базе есть контрагент "Надежный Поставщик" с видом "Поставщик", используемый во многих сценариях закупок.

*   **❌ Неправильно:**
    ```gherkin
    Сценарий: Переквалификация поставщика в покупателя
        Дано я открываю карточку контрагента "Надежный Поставщик"
        Когда я изменяю вид контрагента на "Покупатель"
        И я сохраняю изменения
        Тогда вид контрагента "Надежный Поставщик" успешно изменен на "Покупатель"
    ```
    В чем тут проблема: все последующие сценарии, ожидающие, что "Надежный Поставщик" - это поставщик, теперь упадут.


*   **✔️ Правильно:**
    ```gherkin
    Сценарий: Переквалификация поставщика в покупателя
        Дано создан новый контрагент "Тестовый поставщик для Переквалификации" с видом "Поставщик"
        Когда я открываю карточку контрагента "Тестовый поставщик для Переквалификации"
        И я изменяю вид контрагента на "Покупатель"
        И я сохраняю изменения
        Тогда вид контрагента "Тестовый поставщик для Переквалификации" успешно изменен на "Покупатель"
    ```
    Данный сценарий работает со своими изолированным набором данных - с контрагентом, которого сам и создает и тем самым не влияет на другие сценарии.

